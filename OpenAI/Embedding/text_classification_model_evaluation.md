# 文本分类模型对比评估

文本数据文件：[./data/20_newsgroup_with_embedding.parquet](<./data/20_newsgroup_with_embedding.parquet>)

使用不同模型进行训练预测的评估报告

## 随机森林模型（Random Forest）

```txt
样本数据概览：
数据集形状: (10640, 5)
列名: ['text', 'target', 'title', 'n_tokens', 'embedding']
类别数量: 20

训练结果：
              precision    recall  f1-score   support

           0       0.55      0.52      0.54        79
           1       0.65      0.69      0.67        98
           2       0.69      0.70      0.69       119
           3       0.58      0.67      0.62       114
           4       0.77      0.61      0.68       114
           5       0.86      0.86      0.86       108
           6       0.82      0.82      0.82       109
           7       0.83      0.83      0.83       106
           8       0.74      0.75      0.74       104
           9       0.75      0.91      0.82       108
          10       0.89      0.85      0.87        91
          11       0.89      0.69      0.78       106
          12       0.72      0.67      0.69       102
          13       0.79      0.85      0.82       104
          14       0.69      0.82      0.75        95
          15       0.65      0.89      0.75        97
          16       0.61      0.81      0.69        91
          17       0.84      0.84      0.84       100
          18       0.67      0.57      0.62        89
          19       0.80      0.06      0.11        66

    accuracy                           0.73      2000
   macro avg       0.74      0.72      0.71      2000
weighted avg       0.74      0.73      0.72      2000

更多分析：
对数损失：1.6674
平均置信度：0.2672
低置信度（<0.6）样本比例：97.70%
```

![随机森林模型归一化混沌矩阵](<./img/random_forest_normalized_confusion_matrix.svg>)

```txt
分析类别 19：
被误判为类别 15 的样本数: 24 (36.4%)
被误判为类别 16 的样本数: 14 (21.2%)
被误判为类别  0 的样本数: 10 (15.2%)
被误判为类别 17 的样本数:  4 (6.1%)
被误判为类别 18 的样本数:  3 (4.5%)
被误判为类别 13 的样本数:  3 (4.5%)
被误判为类别 14 的样本数:  2 (3.0%)
被误判为类别  7 的样本数:  1 (1.5%)
被误判为类别  8 的样本数:  1 (1.5%)
```

---

## 逻辑回归模型（Logistic Regression）

```txt
样本数据概览：
数据集形状: (10640, 5)
列名: ['text', 'target', 'title', 'n_tokens', 'embedding']
类别数量: 20

训练结果：
              precision    recall  f1-score   support

           0       0.61      0.62      0.62        79
           1       0.69      0.77      0.72        98
           2       0.67      0.76      0.71       119
           3       0.67      0.69      0.68       114
           4       0.82      0.67      0.73       114
           5       0.92      0.87      0.90       108
           6       0.83      0.82      0.82       109
           7       0.88      0.86      0.87       106
           8       0.85      0.75      0.80       104
           9       0.80      0.94      0.87       108
          10       0.94      0.90      0.92        91
          11       0.84      0.74      0.78       106
          12       0.70      0.74      0.72       102
          13       0.91      0.84      0.87       104
          14       0.78      0.86      0.82        95
          15       0.80      0.85      0.82        97
          16       0.68      0.77      0.72        91
          17       0.87      0.87      0.87       100
          18       0.65      0.74      0.69        89
          19       0.67      0.39      0.50        66

    accuracy                           0.78      2000
   macro avg       0.78      0.77      0.77      2000
weighted avg       0.78      0.78      0.78      2000

更多分析：
对数损失：0.7301
平均置信度：0.8070
低置信度（<0.6）样本比例：20.65%
```

![逻辑回归模型归一化混沌矩阵](<./img/logistic_regression_normalized_confusion_matrix.svg>)

```txt
分析类别 19：
被误判为类别 15 的样本数: 12 (18.2%)
被误判为类别 16 的样本数: 11 (16.7%)
被误判为类别  0 的样本数:  9 (13.6%)
被误判为类别 18 的样本数:  4 (6.1%)
被误判为类别  1 的样本数:  2 (3.0%)
被误判为类别  8 的样本数:  1 (1.5%)
被误判为类别 14 的样本数:  1 (1.5%)
```

---

## 梯度提升决策树模型（Light Gradient Boosting Machine）

```txt
样本数据概览：
数据集形状: (10640, 5)
列名: ['text', 'target', 'title', 'n_tokens', 'embedding']
类别数量: 20

Training until validation scores don't improve for 20 rounds
Early stopping, best iteration is:
[330]	valid_0's multi_logloss: 0.760011
训练结果：
              precision    recall  f1-score   support

           0       0.58      0.66      0.62        79
           1       0.69      0.78      0.73        98
           2       0.76      0.79      0.78       119
           3       0.66      0.69      0.68       114
           4       0.76      0.68      0.72       114
           5       0.88      0.84      0.86       108
           6       0.82      0.81      0.81       109
           7       0.87      0.80      0.83       106
           8       0.76      0.76      0.76       104
           9       0.84      0.94      0.89       108
          10       0.93      0.89      0.91        91
          11       0.87      0.71      0.78       106
          12       0.75      0.73      0.74       102
          13       0.88      0.88      0.88       104
          14       0.74      0.82      0.78        95
          15       0.78      0.82      0.80        97
          16       0.69      0.78      0.73        91
          17       0.89      0.87      0.88       100
          18       0.61      0.73      0.67        89
          19       0.56      0.23      0.32        66

    accuracy                           0.77      2000
   macro avg       0.77      0.76      0.76      2000
weighted avg       0.77      0.77      0.77      2000

更多分析：
对数损失：0.7856
平均置信度：0.7959
低置信度（<0.6）样本比例：22.65%
```

![梯度提升决策树模型归一化混沌矩阵](<./img/lightgbm_normalized_confusion_matrix.svg>)

```txt
分析类别 19：
被误判为类别 16 的样本数: 15 (22.7%)
被误判为类别 15 的样本数: 14 (21.2%)
被误判为类别  0 的样本数: 10 (15.2%)
被误判为类别 18 的样本数:  6 (9.1%)
被误判为类别 17 的样本数:  2 (3.0%)
被误判为类别 14 的样本数:  2 (3.0%)
被误判为类别 13 的样本数:  1 (1.5%)
被误判为类别  8 的样本数:  1 (1.5%)
```
